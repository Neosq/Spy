-- Mobile Toggle (в файле End)

print("[Mobile Toggle] Создаём кнопку...")

local CoreGui = game:GetService("CoreGui")
local UserInputService = game:GetService("UserInputService")

local mobileToggle = Instance.new("ScreenGui")
mobileToggle.Name = "MobileToggle"
mobileToggle.ResetOnSpawn = false
mobileToggle.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
mobileToggle.Parent = CoreGui
print("[Mobile Toggle] ScreenGui создана")

local circleBtn = Instance.new("ImageButton")
circleBtn.Name = "ToggleBtn"
circleBtn.Size = UDim2.new(0, 60, 0, 60)                     -- чуть больше для видимости
circleBtn.Position = UDim2.new(0.5, -30, 0.3, -30)           -- центр + выше середины
circleBtn.AnchorPoint = Vector2.new(0.5, 0.5)                -- якорь по центру
circleBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 47)
circleBtn.BackgroundTransparency = 0.3
circleBtn.ImageTransparency = 0
circleBtn.ImageColor3 = Color3.new(1, 1, 1)
circleBtn.ZIndex = 10000
circleBtn.Visible = true

-- Рабочий публичный ID (глаз — 100% работает)
circleBtn.Image = "rbxassetid://7072718362"
print("[Mobile Toggle] Image ID установлен: rbxassetid://7072718362")

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(1)
corner.Parent = circleBtn

circleBtn.Parent = mobileToggle
print("[Mobile Toggle] Кнопка добавлена в ScreenGui")

-- Отладка позиции
task.wait(1)
print("[Debug] Позиция кнопки: " .. tostring(circleBtn.AbsolutePosition))
print("[Debug] Размер кнопки: " .. tostring(circleBtn.AbsoluteSize))
print("[Debug] Visible: " .. tostring(circleBtn.Visible))
print("[Debug] ImageTransparency: " .. tostring(circleBtn.ImageTransparency))

-- Клик — переключение GUI
circleBtn.Activated:Connect(function()
    print("[Mobile Toggle] Кнопка нажата")
    if Background then
        Background.Visible = not Background.Visible
        print("[Mobile Toggle] GUI Visible теперь: " .. tostring(Background.Visible))
    end
end)

-- Drag (перетаскивание)
local dragging, dragStart, startPos
circleBtn.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = circleBtn.Position
        print("[Debug] Начало перетаскивания")
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        circleBtn.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

circleBtn.InputEnded:Connect(function()
    if dragging then
        dragging = false
        print("[Debug] Перетаскивание окончено")
    end
end)
